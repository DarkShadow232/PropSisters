# 🗄️ دليل تهيئة قاعدة البيانات

## نظرة عامة

هذا الدليل يوضح كيفية تهيئة قاعدة بيانات Firebase Firestore للمشروع وإضافة البيانات الأولية المطلوبة.

## 📋 المتطلبات

- تم إعداد Firebase بشكل صحيح
- متغيرات البيئة محددة في `.env.local`
- الاتصال بالإنترنت للوصول إلى Firebase

## 🚀 طرق التهيئة

### الطريقة الأولى: واجهة المستخدم الرسومية

1. **الوصول إلى صفحة التهيئة:**
   ```
   http://localhost:8080/admin/init
   ```

2. **أو من الصفحة الرئيسية:**
   - في وضع التطوير، ستجد قسم "أدوات المطور" في أسفل الصفحة الرئيسية
   - انقر على زر "تهيئة قاعدة البيانات"

3. **خطوات التهيئة:**
   - فحص حالة قاعدة البيانات
   - النقر على "تهيئة قاعدة البيانات"
   - انتظار اكتمال العملية
   - مراجعة الرسائل للتأكد من نجاح العملية

### الطريقة الثانية: البرمجية

```typescript
import { initializeFirestore } from '@/utils/initializeFirestore';

// تهيئة قاعدة البيانات
const result = await initializeFirestore();
if (result.success) {
  console.log('تم تهيئة قاعدة البيانات بنجاح!');
} else {
  console.error('فشل في التهيئة:', result.message);
}
```

## 📊 البيانات المضافة

### 1. العقارات (Properties)
- **المصدر:** `src/data/rentalData.ts`
- **العدد:** جميع العقارات المتاحة في الملف
- **المعلومات:** العنوان، الموقع، السعر، المرافق، الصور، المالك

### 2. المراجعات (Reviews)
- **المصدر:** مراجعات مرتبطة بكل عقار
- **المعلومات:** اسم المستخدم، التقييم، التعليق، تاريخ الإنشاء

### 3. الحجوزات (Bookings)
- **العدد:** 3 حجوزات نموذجية
- **الحالات:** مؤكدة، معلقة، مكتملة
- **المعلومات:** بيانات الضيف، تواريخ الإقامة، السعر الإجمالي

### 4. طلبات التصميم (Design Requests)
- **العدد:** 2 طلب نموذجي
- **الأنواع:** تصميم غرفة معيشة، تجديد مطبخ
- **المعلومات:** بيانات العميل، الوصف، الميزانية، الحالة

### 5. المستخدمين (Users)
- **العدد:** 2 مستخدم نموذجي
- **المعلومات:** البريد الإلكتروني، الاسم، الهاتف، مستوى العضوية

### 6. إعدادات التطبيق (App Settings)
- **المعلومات:** اسم الموقع، معلومات الاتصال، إعدادات الحجز، طرق الدفع

## 🔧 الوظائف المتاحة

### `initializeFirestore()`
- **الوصف:** تهيئة قاعدة البيانات بالبيانات الأولية
- **الإرجاع:** `{ success: boolean, message: string }`

### `isDatabaseEmpty()`
- **الوصف:** فحص ما إذا كانت قاعدة البيانات فارغة
- **الإرجاع:** `boolean`

### `resetDatabase()`
- **الوصف:** إعادة تعيين قاعدة البيانات (تحذير!)
- **الإرجاع:** `{ success: boolean, message: string }`

## ⚠️ تحذيرات مهمة

1. **النسخ الاحتياطي:**
   - تأكد من عمل نسخة احتياطية قبل إعادة التعيين
   - احفظ البيانات المهمة قبل التهيئة

2. **البيئة:**
   - تأكد من استخدام قاعدة بيانات التطوير وليس الإنتاج
   - راجع متغيرات البيئة قبل التهيئة

3. **الأذونات:**
   - تأكد من وجود أذونات الكتابة في Firebase
   - راجع قواعد الأمان في Firestore

## 🔍 استكشاف الأخطاء

### خطأ في الاتصال
```
Error: Firebase configuration is invalid
```
**الحل:** راجع متغيرات البيئة في `.env.local`

### خطأ في الأذونات
```
Error: Missing or insufficient permissions
```
**الحل:** راجع قواعد الأمان في Firebase Console

### خطأ في البيانات
```
Error: Invalid data format
```
**الحل:** تأكد من صحة تنسيق البيانات في `rentalData.ts`

## 📱 مراقبة العملية

### في وحدة التحكم
```javascript
// مراقبة العملية
console.log('🚀 بدء تهيئة قاعدة البيانات...');
console.log('🏠 إضافة العقارات...');
console.log('📅 إضافة الحجوزات النموذجية...');
console.log('🎨 إضافة طلبات التصميم...');
console.log('👥 إضافة المستخدمين النموذجيين...');
console.log('⚙️ إضافة إعدادات التطبيق...');
console.log('✅ تم تهيئة قاعدة البيانات بنجاح!');
```

### في Firebase Console
- انتقل إلى Firebase Console
- اختر مشروعك
- انتقل إلى Firestore Database
- تحقق من وجود المجموعات الجديدة

## 🔄 التحديث والصيانة

### إضافة بيانات جديدة
1. حدث ملف `rentalData.ts`
2. أضف البيانات الجديدة إلى `initializeFirestore.ts`
3. أعد تشغيل عملية التهيئة

### تحديث البيانات الموجودة
1. استخدم Firebase Console للتحديث اليدوي
2. أو أنشئ سكريبت تحديث مخصص

## 📞 الدعم

إذا واجهت أي مشاكل:
1. راجع هذا الدليل أولاً
2. تحقق من وحدة التحكم للأخطاء
3. راجع Firebase Console
4. تواصل مع فريق التطوير

---

**ملاحظة:** هذه الأدوات مخصصة للتطوير والاختبار. استخدمها بحذر في بيئة الإنتاج.